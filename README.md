# Go番茄钟计时器

一个功能丰富的命令行番茄钟计时器，使用 Go 语言编写。

## 目录结构

```
cmd/
  gomato/
    main.go         # 程序入口，负责依赖注入和启动
pkg/
  app/              # 应用主逻辑，命令处理
  menu/             # 菜单与交互逻辑
  timer/            # 计时器核心，任务存储与计时逻辑
  task/             # 任务管理（增删查改、持久化）
  setting/          # 应用设置管理
  config/           # 配置结构体与默认值
  common/           # 通用工具（如终端颜色）
```

## 功能特点

- 可自定义工作和休息时间
- 多种计时器显示方式（普通显示、ANSI字符艺术显示）
- 设置菜单功能（时间显示格式、查看/重置设置）
- 任务管理（添加、完成、删除、清空、最近任务）
- 统计功能（工作/休息会话数、总工作时长、任务完成率）
- 实时显示剩余时间
- 支持优雅退出（Ctrl+C）
- 任务数据自动保存和加载
- 跨平台支持（根据操作系统自动选择清屏方式）

## 安装与运行

1. 确保已安装 Go 1.21 或更高版本
2. 克隆此仓库
3. 运行程序：

### 方式一：直接运行（推荐）
```bash
go run cmd/gomato/main.go
```

### 方式二：编译后运行
```bash
# 编译
go build -o gomato cmd/gomato/main.go

# 运行
./gomato
```

## 菜单操作

- 添加新任务
- 查看所有任务
- 查看最近任务
- 开始专注任务（可自定义本次工作/休息时间）
- 标记任务完成
- 删除任务
- 清空所有任务
- 设置（时间显示格式、查看当前设置、重置为默认设置）
- 退出

## 交互命令（计时界面下）

- `help`      - 显示帮助信息
- `stats`     - 显示统计信息
- `tasks`     - 显示任务列表
- `add <描述>` - 添加新任务
- `complete <ID>` - 完成任务
- `work <时间>`   - 设置工作时间（如：25m）
- `break <时间>`  - 设置休息时间（如：5m）
- `name <名称>`   - 设置当前任务名称
- `pause`     - 暂停计时
- `resume`    - 恢复计时
- `start`     - 手动开始计时（非自动模式）
- `quit`      - 退出计时

### 快捷键

- `g` - 开始计时
- `p` - 暂停
- `r` - 恢复
- `s` - 统计
- `t` - 任务
- `h` - 帮助
- `q` - 退出

### 时间格式示例

- `25m` - 25分钟
- `1h`  - 1小时
- `30s` - 30秒

## 计时器显示

支持两种计时器显示方式：

1. **普通显示** - 传统的数字时间显示
2. **ANSI字符艺术显示** - 使用ANSI字符艺术效果显示时间

可通过设置菜单切换显示方式。

## 设置功能

- **时间显示格式** - 选择计时器的显示方式
- **查看当前设置** - 显示所有当前配置
- **重置为默认设置** - 恢复所有设置为默认值

## 统计信息

- 工作会话数
- 休息会话数
- 总工作时间
- 任务完成率

## 任务管理

- 可添加多个任务
- 标记任务完成状态
- 查看任务列表和状态
- 任务数据自动保存到 `~/.gomato/tasks.json`
- 程序启动时自动加载已保存的任务

## 数据存储

- 任务数据保存在用户主目录下的 `.gomato` 文件夹中
- 任务数据文件：`~/.gomato/tasks.json`
- 单个任务配置：`~/.gomato/task.json`
- 数据会在以下情况下自动保存：
  - 添加新任务时
  - 完成任务时
  - 修改任务状态时

## 开发与测试

- 代码遵循 `cmd/` 和 `pkg/` 的标准 Go 项目布局
- 运行全部测试：

```bash
go test ./...
```

## 最近更新

- ✨ **项目结构重构**：采用 `cmd` 和 `pkg` 标准布局，提升可维护性。
- ✨ 新增ANSI字符艺术计时器显示功能
- ⚙️ 添加设置菜单，支持时间显示格式配置
- 🔧 重构配置管理，优化代码结构
- 🐛 修复暂停时计时器未真正暂停的bug
- 🌍 根据运行时检测操作系统进行清屏操作

## 常见问题

- 仅支持类Unix终端（如Linux/macOS）
- 确保终端支持ANSI转义序列以获得最佳显示效果

## 贡献

欢迎提交PR或issue！

---

感谢使用本番茄钟计时器！ 